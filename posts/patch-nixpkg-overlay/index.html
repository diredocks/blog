<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width">

<link rel="icon" href="https://diredocks.github.io/blog/favicon.ico">

<title>给 Nixpkgs 里的软件打上你自己的补丁 | ike</title>

      <link rel="stylesheet" href="/blog/css/main.min.27506aec8cbfd935e83a05088e2071a4881b50859cd3bb300c5efcfd14b5a208.css" integrity="sha256-J1Bq7Iy/2TXoOgUIjiBxpIgbUIWc07swDF78/RS1ogg=" crossorigin="anonymous">


      <script src="/blog/js/main.23cd0c7d837263b9eaeb96ee2d9ccfa2969daa3fa00fa1c1fe8701a9b87251a1.js" integrity="sha256-I80MfYNyY7nq65buLZzPopadqj&#43;gD6HB/ocBqbhyUaE=" crossorigin="anonymous"></script>


</head>
<body>
  <div class="site">
  <header>
    <div class="header-info">
  <h1>ike</h1>
  <p>SELECT writings, tech FROM diredocks WHERE mood = &#39;❄️&#39;;</p>
</div>

  <nav>
    <ul>
    <li>
      <a href="/blog/">主页</a>
    </li>
    <li>
      <a aria-current="true" class="ancestor" href="/blog/posts/">文章</a>
    </li>
    <li>
      <a href="/blog/tags/">标签</a>
    </li>
    <li>
      <a href="/blog/about/">我</a>
    </li>
    <li>
      <a href="/blog/index.xml">订阅</a>
    </li>
    </ul>
  </nav>


  </header>
  <main>
    
<article>
  <div class="article-info">
  <h1>给 Nixpkgs 里的软件打上你自己的补丁</h1>

  
  
  <time datetime="2024-11-26T21:25:12&#43;08:00">2024-11-26</time>
  </div>

  <p>我最近给 KWin 加上了触控板三指水平滑动切换窗口的功能，很不幸由于和目前的手势分配有冲突，合并请求被搁置了。但是咱都有源码了，还能干等着不成？</p>
<p>在 ArchLinux 里，给已有的包打上自己的补丁，只需要抄一下官方仓库里的 PKGBUILD，加上补丁，然后自己构建安装即可。在 NixOS 里也是差不多的，用 overlay 覆盖 nixpkgs 里的包，好处是将来的更新无需手动同步版本，因为只是覆盖原有包的某些构建阶段，一劳永逸。</p>
<p>NixOS Wiki 里其实说了应该<a href="https://nixos.wiki/wiki/Overlays">怎么做</a>，不过作为小白我还是遇到了点坑：在某个 scope（你可以理解为包组）里的包不能直接覆盖，而是应该覆盖整个 scope，让覆盖的 scope 里的包改变。</p>
<p>具体怎么配置请参考这里：https://github.com/diredocks/nix-config/blob/master/nixos/nix.nix#L17 ，<del>不说了，触控板手势的确很爽</del>。</p>

  


</article>

  <nav class="nav-single">



<a class="nav-prev" href="/blog/posts/review-computer-networking/"> ← 计算机网络复习</a>



<a class="nav-next" href="/blog/posts/choose-life/"> Choose Life → </a>

</nav>


  </main>
  <footer>
    <p>Built with Hugo 0.140.1</p>
<p>last built on 2025-01-07 23:46</p>

  </footer>
  </div>
</body>
</html>
